<!DOCTYPE html>
<html lang="en">
{{> layout/head}}
<body>
    <div class="container-fluid">
        <div class="row">
            {{> layout/sidebar}}
            
            <!-- Main Content -->
            <main class="col-lg-9 col-md-8 main-content">
                <div class="container py-5">
                    {{> sections/summary}}
                    {{> sections/experience}}
                    {{> sections/volunteer}}
                    {{> sections/education}}
                    {{> sections/projects}}
                    {{> sections/skills}}
                    {{> sections/awards}}
                    {{> sections/certificates}}
                    {{> sections/publications}}
                    {{> sections/references}}
                </div>
            </main>
        </div>
    </div>
    
    {{> layout/navigation}}
    
    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Smart Fixed Navigation
        (function() {
            const nav = document.getElementById('smart-nav');
            const trigger = nav.querySelector('.nav-trigger');
            const menu = nav.querySelector('.nav-menu');
            const links = nav.querySelectorAll('.nav-link');
            let scrolling = false;
            let scrollTimeout;
            
            // Toggle menu
            trigger.addEventListener('click', function(e) {
                e.preventDefault();
                nav.classList.toggle('nav-open');
            });
            
            // Close menu when clicking a link
            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        nav.classList.remove('nav-open');
                    }
                });
            });
            
            // Show/hide nav based on scroll
            function checkScroll() {
                const scrollY = window.scrollY;
                
                if (scrollY > 300) {
                    nav.classList.add('nav-visible');
                } else {
                    nav.classList.remove('nav-visible');
                    nav.classList.remove('nav-open');
                }
                
                // Hide nav while scrolling
                if (!scrolling) {
                    nav.classList.add('nav-scrolling');
                    scrolling = true;
                }
                
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(function() {
                    nav.classList.remove('nav-scrolling');
                    scrolling = false;
                }, 150);
                
                // Highlight active section
                updateActiveSection();
            }
            
            // Update active section in nav
            function updateActiveSection() {
                const sections = document.querySelectorAll('section[id]');
                const scrollY = window.scrollY;
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - 100;
                    const sectionBottom = sectionTop + section.offsetHeight;
                    const sectionId = section.getAttribute('id');
                    const navLink = nav.querySelector(`a[href="#${sectionId}"]`);
                    
                    if (navLink) {
                        if (scrollY >= sectionTop && scrollY < sectionBottom) {
                            navLink.classList.add('active');
                        } else {
                            navLink.classList.remove('active');
                        }
                    }
                });
            }
            
            // Close menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!nav.contains(e.target)) {
                    nav.classList.remove('nav-open');
                }
            });
            
            // Listen for scroll events
            let ticking = false;
            function requestTick() {
                if (!ticking) {
                    window.requestAnimationFrame(checkScroll);
                    ticking = true;
                    setTimeout(() => { ticking = false; }, 100);
                }
            }
            
            window.addEventListener('scroll', requestTick);
            
            // Initial check
            checkScroll();
        })();
    </script>
</body>
</html>